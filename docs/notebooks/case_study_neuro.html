

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Inferring RNA velocities on each branch for branching genes in the mouse hippocampus development &mdash; cellDancer  documentation</title>
  

  
  <link rel="stylesheet" href="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/documentation_options.js"></script>
        <script src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/jquery.js"></script>
        <script src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/underscore.js"></script>
        <script src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Deciphering cell identity using the cell-specific reaction rates in pancreatic endocrinogenesis" href="case_study_pancreas.html" />
    <link rel="prev" title="Delineating the transcriptional boost on single-cell resolution in gastrulation erythroid maturation" href="case_study_gastrulation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> cellDancer
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">cellDancer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../API.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_preprocessing.html">Data Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="case_study_gastrulation.html">Delineating the transcriptional boost on single-cell resolution in gastrulation erythroid maturation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Inferring RNA velocities on each branch for branching genes in the mouse hippocampus development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Import-packages">Import packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Load-data">Load data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Estimate-RNA-velocity-for-sample-genes">Estimate RNA velocity for sample genes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Visualize-the-phase-portraits">Visualize the phase portraits</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Project-the-RNA-velocity-onto-the-embedding-space">Project the RNA velocity onto the embedding space</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Estimate-pseudotime">Estimate pseudotime</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Display-the-abundance-of-spliced-RNA-along-pseudotime">Display the abundance of spliced RNA along pseudotime</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Visualize-the-reaction-rates,-the-abundance-of-unspliced-RNA,-and-the-abundance-of-spliced-RNA-on-embedding-space">Visualize the reaction rates, the abundance of unspliced RNA, and the abundance of spliced RNA on embedding space</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="case_study_pancreas.html">Deciphering cell identity using the cell-specific reaction rates in pancreatic endocrinogenesis</a></li>
<li class="toctree-l1"><a class="reference internal" href="case_study_hgforebrian.html">Decoding the human embryo glutamatergic neurogenesis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Application of dynamo</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="case_study_pancreas_dynamo.html">Deciphering gene regulation through vector fields analysis in pancreatic endocrinogenesis</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">cellDancer</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Inferring RNA velocities on each branch for branching genes in the mouse hippocampus development</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/notebooks/case_study_neuro.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="Inferring-RNA-velocities-on-each-branch-for-branching-genes-in-the-mouse-hippocampus-development">
<h1>Inferring RNA velocities on each branch for branching genes in the mouse hippocampus development<a class="headerlink" href="#Inferring-RNA-velocities-on-each-branch-for-branching-genes-in-the-mouse-hippocampus-development" title="Permalink to this headline">¶</a></h1>
<p>This tutorial shows how cellDancer analyzes RNA velocity. The process includes (1) estimating RNA velocity, (2) deriving cell fates on embedding space, (3) estimating pseudotime, and (4) displaying predicted kinetics rates (transcription, splicing, and degradation rates), spliced mRNA abundance, and unspliced mRNA abundance on embedding space.</p>
<p>Below is the case study for the mouse hippocampal dentate gyrus neurogenesis. We follow the preprocessing methods of <a class="reference external" href="https://www.nature.com/articles/s41587-020-0591-3">La Manno et al.</a> to filter genes and cells. 18,140 cells with 2,159 genes were selected.</p>
<div class="section" id="Import-packages">
<h2>Import packages<a class="headerlink" href="#Import-packages" title="Permalink to this headline">¶</a></h2>
<p>To run the notebook locally, <a class="reference external" href="installation.html">Installation</a> could be referred to install the environment and dependencies.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import packages</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">celldancer</span> <span class="k">as</span> <span class="nn">cd</span>
<span class="kn">import</span> <span class="nn">celldancer.cdplt</span> <span class="k">as</span> <span class="nn">cdplt</span>
<span class="kn">from</span> <span class="nn">celldancer.cdplt</span> <span class="kn">import</span> <span class="n">colormap</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Load-data">
<h2>Load data<a class="headerlink" href="#Load-data" title="Permalink to this headline">¶</a></h2>
<p>The input data for cellDancer contains the preprocessed abundances of unspliced RNA and spliced RNA. The data of mouse hippocampal dentate gyrus neurogenesis can be ownloaded from <a class="reference external" href="https://drive.google.com/file/d/1wm_frx0Zq6OVN4Eu8xXAX5ggHwXfg3xe/view?usp=sharing">DentateGyrus_cell_type_u_s.csv.zip</a>. To load your own data, the dataframe should contain columns ‘gene_name’, ‘unsplice’, ‘splice’ ,‘cellID’ ,‘clusters’ ,‘embedding1’, and ‘embedding2.’ For a detailed description about the
preprocessing and the data structure, refer to <a class="reference external" href="data_preprocessing.html">Data Preparation</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cell_type_u_s_path</span><span class="o">=</span><span class="s2">&quot;your_path/DentateGyrus_cell_type_u_s.csv&quot;</span>
<span class="n">cell_type_u_s</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">cell_type_u_s_path</span><span class="p">)</span>
<span class="n">cell_type_u_s</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>gene_name</th>
      <th>unsplice</th>
      <th>splice</th>
      <th>cellID</th>
      <th>clusters</th>
      <th>embedding1</th>
      <th>embedding2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Rgs20</td>
      <td>0.069478</td>
      <td>0.021971</td>
      <td>10X83_2:AAACGGGGTCTCTTTAx</td>
      <td>ImmGranule2</td>
      <td>18.931086</td>
      <td>-1.862429</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Rgs20</td>
      <td>0.085834</td>
      <td>0.016256</td>
      <td>10X83_2:AACCATGGTTCAACCAx</td>
      <td>ImmGranule2</td>
      <td>18.419891</td>
      <td>-1.282895</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Rgs20</td>
      <td>0.068644</td>
      <td>0.047774</td>
      <td>10X83_2:AACACGTTCTGAAAGAx</td>
      <td>CA2-3-4</td>
      <td>2.369887</td>
      <td>16.868419</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Rgs20</td>
      <td>0.045387</td>
      <td>0.018101</td>
      <td>10X83_2:AAAGATGCATTGAGCTx</td>
      <td>CA</td>
      <td>-5.351040</td>
      <td>10.676485</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Rgs20</td>
      <td>0.040457</td>
      <td>0.012846</td>
      <td>10X83_2:AACCATGTCTACTTACx</td>
      <td>CA1-Sub</td>
      <td>-6.189126</td>
      <td>11.754900</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>39164255</th>
      <td>Gpm6b</td>
      <td>0.876650</td>
      <td>1.276089</td>
      <td>10X84_3:TTTCCTCCACCATCCTx</td>
      <td>ImmGranule1</td>
      <td>10.812611</td>
      <td>-2.487668</td>
    </tr>
    <tr>
      <th>39164256</th>
      <td>Gpm6b</td>
      <td>2.024897</td>
      <td>5.152006</td>
      <td>10X84_3:TTTGTCACATGAAGTAx</td>
      <td>CA2-3-4</td>
      <td>8.246204</td>
      <td>23.482788</td>
    </tr>
    <tr>
      <th>39164257</th>
      <td>Gpm6b</td>
      <td>1.848051</td>
      <td>1.491445</td>
      <td>10X84_3:TTTCCTCCACGGTAAGx</td>
      <td>nIPC</td>
      <td>-3.441272</td>
      <td>-4.917364</td>
    </tr>
    <tr>
      <th>39164258</th>
      <td>Gpm6b</td>
      <td>0.696361</td>
      <td>1.189091</td>
      <td>10X84_3:TTTGTCAAGCGTCAAGx</td>
      <td>ImmGranule2</td>
      <td>16.394199</td>
      <td>-6.143549</td>
    </tr>
    <tr>
      <th>39164259</th>
      <td>Gpm6b</td>
      <td>0.739348</td>
      <td>1.239052</td>
      <td>10X84_3:TTTCCTCGTGAAAGAGx</td>
      <td>ImmGranule2</td>
      <td>17.490857</td>
      <td>-4.130190</td>
    </tr>
  </tbody>
</table>
<p>39164260 rows × 7 columns</p>
</div></div>
</div>
</div>
<div class="section" id="Estimate-RNA-velocity-for-sample-genes">
<h2>Estimate RNA velocity for sample genes<a class="headerlink" href="#Estimate-RNA-velocity-for-sample-genes" title="Permalink to this headline">¶</a></h2>
<p>We use <code class="docutils literal notranslate"><span class="pre">cd.velocity()</span></code> to estimate the velocity. Here, 30 genes in <code class="docutils literal notranslate"><span class="pre">gene_list</span></code> are estimated as an example. The predicted unspliced and spliced reads, alpha, beta, and gamma are added to the dataframe.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gene_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Psd3&#39;</span><span class="p">,</span> <span class="s1">&#39;Dcx&#39;</span><span class="p">,</span> <span class="s1">&#39;Syt11&#39;</span><span class="p">,</span> <span class="s1">&#39;Ntrk2&#39;</span><span class="p">,</span> <span class="s1">&#39;Gnao1&#39;</span><span class="p">,</span> <span class="s1">&#39;Gria1&#39;</span><span class="p">,</span> <span class="s1">&#39;Dctn3&#39;</span><span class="p">,</span> <span class="s1">&#39;Map1b&#39;</span><span class="p">,</span> <span class="s1">&#39;Camk2a&#39;</span><span class="p">,</span> <span class="s1">&#39;Gpm6b&#39;</span><span class="p">,</span> <span class="s1">&#39;Sez6l&#39;</span><span class="p">,</span> <span class="s1">&#39;Evl&#39;</span><span class="p">,</span> <span class="s1">&#39;Astn1&#39;</span><span class="p">,</span> <span class="s1">&#39;Ank2&#39;</span><span class="p">,</span> <span class="s1">&#39;Klf7&#39;</span><span class="p">,</span> <span class="s1">&#39;Tbc1d16&#39;</span><span class="p">,</span> <span class="s1">&#39;Atp1a3&#39;</span><span class="p">,</span> <span class="s1">&#39;Stxbp6&#39;</span><span class="p">,</span> <span class="s1">&#39;Scn2a1&#39;</span><span class="p">,</span> <span class="s1">&#39;Lhx9&#39;</span><span class="p">,</span> <span class="s1">&#39;Slc4a4&#39;</span><span class="p">,</span> <span class="s1">&#39;Ppfia2&#39;</span><span class="p">,</span> <span class="s1">&#39;Kcnip1&#39;</span><span class="p">,</span> <span class="s1">&#39;Ptpro&#39;</span><span class="p">,</span> <span class="s1">&#39;Diaph3&#39;</span><span class="p">,</span> <span class="s1">&#39;Slc1a3&#39;</span><span class="p">,</span> <span class="s1">&#39;Cadm1&#39;</span><span class="p">,</span> <span class="s1">&#39;Mef2c&#39;</span><span class="p">,</span> <span class="s1">&#39;Sptbn1&#39;</span><span class="p">,</span> <span class="s1">&#39;Ncald&#39;</span><span class="p">]</span>

<span class="n">loss_df</span><span class="p">,</span> <span class="n">cellDancer_df</span><span class="o">=</span><span class="n">cd</span><span class="o">.</span><span class="n">velocity</span><span class="p">(</span><span class="n">cell_type_u_s</span><span class="p">,</span>
                                   <span class="n">gene_list</span><span class="o">=</span><span class="n">gene_list</span><span class="p">,</span>
                                   <span class="n">permutation_ratio</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                                   <span class="n">norm_u_s</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">norm_cell_distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">n_jobs</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="n">cellDancer_df</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Using /Users/shengyuli/Library/CloudStorage/OneDrive-HoustonMethodist/work/Velocity/bin/cellDancer_polish/analysis/CaseStudyNotebook/cellDancer_velocity_2022-06-27 16-37-44 as the output path.
Arranging genes for parallel job.
30  genes were arranged to  4  portions.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

Velocity Estimation:   0%|          | 0/4 [00:00&lt;?, ?it/s]
Velocity Estimation:  25%|██▌       | 1/4 [00:37&lt;01:53, 37.68s/it]
Velocity Estimation:  50%|█████     | 2/4 [01:04&lt;01:03, 31.53s/it]
Velocity Estimation:  75%|███████▌  | 3/4 [01:31&lt;00:29, 29.08s/it]
Velocity Estimation: 100%|██████████| 4/4 [01:52&lt;00:00, 26.11s/it]

</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cellIndex</th>
      <th>gene_name</th>
      <th>unsplice</th>
      <th>splice</th>
      <th>unsplice_predict</th>
      <th>splice_predict</th>
      <th>alpha</th>
      <th>beta</th>
      <th>gamma</th>
      <th>loss</th>
      <th>cellID</th>
      <th>clusters</th>
      <th>embedding1</th>
      <th>embedding2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Klf7</td>
      <td>0.408467</td>
      <td>1.294797</td>
      <td>0.444935</td>
      <td>1.475828</td>
      <td>0.454905</td>
      <td>0.935128</td>
      <td>0.015373</td>
      <td>0.077489</td>
      <td>10X83_2:AAACGGGGTCTCTTTAx</td>
      <td>ImmGranule2</td>
      <td>18.931086</td>
      <td>-1.862429</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Klf7</td>
      <td>0.379136</td>
      <td>1.256870</td>
      <td>0.411796</td>
      <td>1.424216</td>
      <td>0.419835</td>
      <td>0.935061</td>
      <td>0.015772</td>
      <td>0.077489</td>
      <td>10X83_2:AACCATGGTTCAACCAx</td>
      <td>ImmGranule2</td>
      <td>18.419891</td>
      <td>-1.282895</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>Klf7</td>
      <td>0.893599</td>
      <td>3.395004</td>
      <td>0.969404</td>
      <td>3.832591</td>
      <td>1.033540</td>
      <td>0.986942</td>
      <td>0.001990</td>
      <td>0.077489</td>
      <td>10X83_2:AACACGTTCTGAAAGAx</td>
      <td>CA2-3-4</td>
      <td>2.369887</td>
      <td>16.868419</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>Klf7</td>
      <td>0.640505</td>
      <td>2.739187</td>
      <td>0.669036</td>
      <td>3.047821</td>
      <td>0.684626</td>
      <td>0.979797</td>
      <td>0.003759</td>
      <td>0.077489</td>
      <td>10X83_2:AAAGATGCATTGAGCTx</td>
      <td>CA</td>
      <td>-5.351040</td>
      <td>10.676485</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>Klf7</td>
      <td>0.662303</td>
      <td>2.433943</td>
      <td>0.712970</td>
      <td>2.749427</td>
      <td>0.745024</td>
      <td>0.971894</td>
      <td>0.005226</td>
      <td>0.077489</td>
      <td>10X83_2:AACCATGTCTACTTACx</td>
      <td>CA1-Sub</td>
      <td>-6.189126</td>
      <td>11.754900</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>544195</th>
      <td>18135</td>
      <td>Kcnip1</td>
      <td>0.018745</td>
      <td>0.005679</td>
      <td>0.243844</td>
      <td>0.008779</td>
      <td>0.463909</td>
      <td>0.731405</td>
      <td>1.322285</td>
      <td>0.079982</td>
      <td>10X84_3:TTTCCTCCACCATCCTx</td>
      <td>ImmGranule1</td>
      <td>10.812611</td>
      <td>-2.487668</td>
    </tr>
    <tr>
      <th>544196</th>
      <td>18136</td>
      <td>Kcnip1</td>
      <td>0.148039</td>
      <td>0.093618</td>
      <td>0.380534</td>
      <td>0.085685</td>
      <td>0.572677</td>
      <td>0.727422</td>
      <td>1.319759</td>
      <td>0.079982</td>
      <td>10X84_3:TTTGTCACATGAAGTAx</td>
      <td>CA2-3-4</td>
      <td>8.246204</td>
      <td>23.482788</td>
    </tr>
    <tr>
      <th>544197</th>
      <td>18137</td>
      <td>Kcnip1</td>
      <td>0.080708</td>
      <td>0.032079</td>
      <td>0.312729</td>
      <td>0.040230</td>
      <td>0.522807</td>
      <td>0.728119</td>
      <td>1.323665</td>
      <td>0.079982</td>
      <td>10X84_3:TTTCCTCCACGGTAAGx</td>
      <td>nIPC</td>
      <td>-3.441272</td>
      <td>-4.917364</td>
    </tr>
    <tr>
      <th>544198</th>
      <td>18138</td>
      <td>Kcnip1</td>
      <td>0.078976</td>
      <td>0.033418</td>
      <td>0.310343</td>
      <td>0.040067</td>
      <td>0.520257</td>
      <td>0.728360</td>
      <td>1.323348</td>
      <td>0.079982</td>
      <td>10X84_3:TTTGTCAAGCGTCAAGx</td>
      <td>ImmGranule2</td>
      <td>16.394199</td>
      <td>-6.143549</td>
    </tr>
    <tr>
      <th>544199</th>
      <td>18139</td>
      <td>Kcnip1</td>
      <td>0.050686</td>
      <td>0.019074</td>
      <td>0.279029</td>
      <td>0.024949</td>
      <td>0.493671</td>
      <td>0.729688</td>
      <td>1.322998</td>
      <td>0.079982</td>
      <td>10X84_3:TTTCCTCGTGAAAGAGx</td>
      <td>ImmGranule2</td>
      <td>17.490857</td>
      <td>-4.130190</td>
    </tr>
  </tbody>
</table>
<p>544200 rows × 14 columns</p>
</div></div>
</div>
</div>
<div class="section" id="Visualize-the-phase-portraits">
<h2>Visualize the phase portraits<a class="headerlink" href="#Visualize-the-phase-portraits" title="Permalink to this headline">¶</a></h2>
<p>We visualize the phase portrait of each gene with <code class="docutils literal notranslate"><span class="pre">cdplt.scatter_gene()</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ncols</span><span class="o">=</span><span class="mi">5</span>
<span class="n">height</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gene_list</span><span class="p">)</span><span class="o">/</span><span class="n">ncols</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="n">height</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gene_list</span><span class="p">)):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gene_list</span><span class="p">)</span><span class="o">/</span><span class="n">ncols</span><span class="p">),</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cdplt</span><span class="o">.</span><span class="n">scatter_gene</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s1">&#39;splice&#39;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s1">&#39;unsplice&#39;</span><span class="p">,</span>
        <span class="n">cellDancer_df</span><span class="o">=</span><span class="n">cellDancer_df</span><span class="p">,</span>
        <span class="n">custom_xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">custom_ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="n">colormap</span><span class="o">.</span><span class="n">colormap_neuro</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span>
        <span class="n">velocity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">gene</span><span class="o">=</span><span class="n">gene_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">gene_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_images/notebooks_case_study_neuro_13_0.png" src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_images/notebooks_case_study_neuro_13_0.png" />
</div>
</div>
</div>
<div class="section" id="Project-the-RNA-velocity-onto-the-embedding-space">
<h2>Project the RNA velocity onto the embedding space<a class="headerlink" href="#Project-the-RNA-velocity-onto-the-embedding-space" title="Permalink to this headline">¶</a></h2>
<p>To project the prediction of RNA velocity to velocity onto the embedding space and to estimate pseudotime by using all genes, predicted result can be downloaded from <a class="reference external" href="https://drive.google.com/file/d/1CziKfu_4Lvecfdv9OJ3qktT5-Do0naiE/view?usp=sharing">DentateGyrus_cellDancer_estimation.csv.zip</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load the prediction result of all genes</span>
<span class="n">cellDancer_df_file</span> <span class="o">=</span> <span class="s1">&#39;your_path/DentateGyrus_cellDancer_estimation.csv&#39;</span>
<span class="n">cellDancer_df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">cellDancer_df_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We calculate the projection of RNA velocity on the embedding with <code class="docutils literal notranslate"><span class="pre">cd.compute_cell_velocity()</span></code>. The projected direction on embedding space, i.e. columns ‘velocity1’ and ‘velocity2’ are added to the original dataframe. We use <code class="docutils literal notranslate"><span class="pre">cdplt.scatter_cell()</span></code> to display the predicted direction on embedding space.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># compute cell velocity</span>
<span class="n">cellDancer_df</span><span class="o">=</span><span class="n">cd</span><span class="o">.</span><span class="n">compute_cell_velocity</span><span class="p">(</span><span class="n">cellDancer_df</span><span class="o">=</span><span class="n">cellDancer_df</span><span class="p">)</span>

<span class="c1"># plot cell velocity</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">cdplt</span><span class="o">.</span><span class="n">scatter_cell</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">cellDancer_df</span><span class="p">,</span>
                        <span class="n">colors</span><span class="o">=</span><span class="n">colormap</span><span class="o">.</span><span class="n">colormap_neuro</span><span class="p">,</span>
                        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                        <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                        <span class="n">velocity</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;on&#39;</span><span class="p">,</span>
                        <span class="n">min_mass</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                        <span class="n">arrow_grid</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">30</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_images/notebooks_case_study_neuro_18_0.png" src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_images/notebooks_case_study_neuro_18_0.png" />
</div>
</div>
</div>
<div class="section" id="Estimate-pseudotime">
<h2>Estimate pseudotime<a class="headerlink" href="#Estimate-pseudotime" title="Permalink to this headline">¶</a></h2>
<p>Based on the projection of RNA velocity on embedding space, we estimate the pseudotime with <code class="docutils literal notranslate"><span class="pre">cd.pseudo_time()</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%capture</span>

<span class="c1"># set parameters</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="n">t_total</span> <span class="o">=</span> <span class="p">{</span><span class="n">dt</span><span class="p">:</span> <span class="mi">10000</span><span class="p">}</span>
<span class="n">n_repeats</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># estimate pseudotime</span>
<span class="n">cellDancer_df</span> <span class="o">=</span> <span class="n">cd</span><span class="o">.</span><span class="n">pseudo_time</span><span class="p">(</span><span class="n">cellDancer_df</span><span class="o">=</span><span class="n">cellDancer_df</span><span class="p">,</span>
                                          <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span>
                                          <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span>
                                          <span class="n">t_total</span><span class="o">=</span><span class="n">t_total</span><span class="p">[</span><span class="n">dt</span><span class="p">],</span>
                                          <span class="n">n_repeats</span><span class="o">=</span><span class="n">n_repeats</span><span class="p">,</span>
                                          <span class="n">speed_up</span><span class="o">=</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span><span class="mi">60</span><span class="p">),</span>
                                          <span class="n">n_paths</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
                                          <span class="n">psrng_seeds_diffusion</span><span class="o">=</span><span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_repeats</span><span class="p">)],</span>
                                          <span class="n">n_jobs</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot pseudotime</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">im</span><span class="o">=</span><span class="n">cdplt</span><span class="o">.</span><span class="n">scatter_cell</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span><span class="n">cellDancer_df</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;pseudotime&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">velocity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_images/notebooks_case_study_neuro_22_0.png" src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_images/notebooks_case_study_neuro_22_0.png" />
</div>
</div>
</div>
<div class="section" id="Display-the-abundance-of-spliced-RNA-along-pseudotime">
<h2>Display the abundance of spliced RNA along pseudotime<a class="headerlink" href="#Display-the-abundance-of-spliced-RNA-along-pseudotime" title="Permalink to this headline">¶</a></h2>
<p>We visualize the spliced RNA abundance of some sample genes along pseudotime with <code class="docutils literal notranslate"><span class="pre">cdplt.scatter_gene()</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gene_list</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Psd3&#39;</span><span class="p">,</span> <span class="s1">&#39;Gria1&#39;</span><span class="p">,</span> <span class="s1">&#39;Camk2a&#39;</span><span class="p">,</span> <span class="s1">&#39;Sez6l&#39;</span><span class="p">,</span> <span class="s1">&#39;Ank2&#39;</span><span class="p">,</span> <span class="s1">&#39;Atp1a3&#39;</span><span class="p">,</span> <span class="s1">&#39;Stxbp6&#39;</span><span class="p">,</span> <span class="s1">&#39;Scn2a1&#39;</span><span class="p">,</span> <span class="s1">&#39;Ppfia2&#39;</span><span class="p">,</span> <span class="s1">&#39;Kcnip1&#39;</span><span class="p">,</span> <span class="s1">&#39;Ntrk2&#39;</span><span class="p">,</span> <span class="s1">&#39;Mef2c&#39;</span><span class="p">,</span> <span class="s1">&#39;Sptbn1&#39;</span><span class="p">,</span> <span class="s1">&#39;Ncald&#39;</span><span class="p">,</span><span class="s1">&#39;Dcx&#39;</span><span class="p">,</span> <span class="s1">&#39;Syt11&#39;</span><span class="p">,</span><span class="s1">&#39;Slc1a3&#39;</span><span class="p">,</span> <span class="s1">&#39;Dctn3&#39;</span><span class="p">,</span> <span class="s1">&#39;Map1b&#39;</span><span class="p">,</span> <span class="s1">&#39;Gpm6b&#39;</span><span class="p">,</span> <span class="s1">&#39;Evl&#39;</span><span class="p">,</span> <span class="s1">&#39;Astn1&#39;</span><span class="p">,</span> <span class="s1">&#39;Tbc1d16&#39;</span><span class="p">,</span><span class="s1">&#39;Slc4a4&#39;</span><span class="p">,</span> <span class="s1">&#39;Ptpro&#39;</span><span class="p">]</span>

<span class="n">ncols</span><span class="o">=</span><span class="mi">5</span>
<span class="n">height</span><span class="o">=</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gene_list</span><span class="p">)</span><span class="o">/</span><span class="n">ncols</span><span class="p">)</span><span class="o">*</span><span class="mi">4</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="n">height</span><span class="p">))</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gene_list</span><span class="p">)):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">gene_list</span><span class="p">)</span><span class="o">/</span><span class="n">ncols</span><span class="p">),</span> <span class="n">ncols</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">cdplt</span><span class="o">.</span><span class="n">scatter_gene</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pseudotime&#39;</span><span class="p">,</span>
        <span class="n">y</span><span class="o">=</span><span class="s1">&#39;splice&#39;</span><span class="p">,</span>
        <span class="n">cellDancer_df</span><span class="o">=</span><span class="n">cellDancer_df</span><span class="p">,</span>
        <span class="n">custom_xlim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">custom_ylim</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">colors</span><span class="o">=</span><span class="n">colormap</span><span class="o">.</span><span class="n">colormap_neuro</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
        <span class="n">velocity</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">gene</span><span class="o">=</span><span class="n">gene_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">gene_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_images/notebooks_case_study_neuro_25_0.png" src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_images/notebooks_case_study_neuro_25_0.png" />
</div>
</div>
</div>
<div class="section" id="Visualize-the-reaction-rates,-the-abundance-of-unspliced-RNA,-and-the-abundance-of-spliced-RNA-on-embedding-space">
<h2>Visualize the reaction rates, the abundance of unspliced RNA, and the abundance of spliced RNA on embedding space<a class="headerlink" href="#Visualize-the-reaction-rates,-the-abundance-of-unspliced-RNA,-and-the-abundance-of-spliced-RNA-on-embedding-space" title="Permalink to this headline">¶</a></h2>
<p>cellDancer provides other functions for visualization. we show the predicted kinetics rates (transcription, splicing, and degradation rates), spliced mRNA abundance, and unspliced mRNA abundance on embedding space with <code class="docutils literal notranslate"><span class="pre">cdplt.scatter_cell()</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gene_samples</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Ntrk2&#39;</span><span class="p">,</span><span class="s1">&#39;Psd3&#39;</span><span class="p">,</span><span class="s1">&#39;Dcx&#39;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">gene</span> <span class="ow">in</span> <span class="n">gene_samples</span><span class="p">:</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">cdplt</span><span class="o">.</span><span class="n">scatter_cell</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">cellDancer_df</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;alpha&#39;</span><span class="p">,</span>
                 <span class="n">gene</span><span class="o">=</span><span class="n">gene</span><span class="p">,</span> <span class="n">velocity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">cdplt</span><span class="o">.</span><span class="n">scatter_cell</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">cellDancer_df</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span>
                 <span class="n">gene</span><span class="o">=</span><span class="n">gene</span><span class="p">,</span> <span class="n">velocity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">cdplt</span><span class="o">.</span><span class="n">scatter_cell</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">cellDancer_df</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span>
                 <span class="n">gene</span><span class="o">=</span><span class="n">gene</span><span class="p">,</span> <span class="n">velocity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">cdplt</span><span class="o">.</span><span class="n">scatter_cell</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span><span class="n">cellDancer_df</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;splice&#39;</span><span class="p">,</span>
                 <span class="n">gene</span><span class="o">=</span><span class="n">gene</span><span class="p">,</span> <span class="n">velocity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">cdplt</span><span class="o">.</span><span class="n">scatter_cell</span><span class="p">(</span><span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span><span class="n">cellDancer_df</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;unsplice&#39;</span><span class="p">,</span>
                 <span class="n">gene</span><span class="o">=</span><span class="n">gene</span><span class="p">,</span> <span class="n">velocity</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;alpha-&#39;</span><span class="o">+</span><span class="n">gene</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;beta-&#39;</span><span class="o">+</span><span class="n">gene</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;gamma-&#39;</span><span class="o">+</span><span class="n">gene</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;spliced-&#39;</span><span class="o">+</span><span class="n">gene</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;unspliced-&#39;</span><span class="o">+</span><span class="n">gene</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_images/notebooks_case_study_neuro_28_0.png" src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_images/notebooks_case_study_neuro_28_0.png" />
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_images/notebooks_case_study_neuro_28_1.png" src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_images/notebooks_case_study_neuro_28_1.png" />
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_images/notebooks_case_study_neuro_28_2.png" src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_images/notebooks_case_study_neuro_28_2.png" />
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="case_study_pancreas.html" class="btn btn-neutral float-right" title="Deciphering cell identity using the cell-specific reaction rates in pancreatic endocrinogenesis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="case_study_gastrulation.html" class="btn btn-neutral float-left" title="Delineating the transcriptional boost on single-cell resolution in gastrulation erythroid maturation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, 6.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>