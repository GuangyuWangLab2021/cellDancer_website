

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>celldancer.cdplt.PTO_Graph &mdash; cellDancer  documentation</title>
  

  
  <link rel="stylesheet" href="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/css/theme.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/documentation_options.js"></script>
        <script src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/jquery.js"></script>
        <script src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/underscore.js"></script>
        <script src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    
    <script type="text/javascript" src="https://raw.githack.com/GuangyuWangLab2021/cellDancer_website/main/docs/_static/js/theme.js"></script>

    
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="celldancer.simulation.simulate" href="celldancer.simulation.simulate.html" />
    <link rel="prev" title="celldancer.cdplt.plot_kinetic_para" href="celldancer.cdplt.plot_kinetic_para.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> cellDancer
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">cellDancer</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">About cellDancer</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="API.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="celldancer.adata_to_df_with_embed.html">celldancer.adata_to_df_with_embed</a></li>
<li class="toctree-l2"><a class="reference internal" href="celldancer.to_dynamo.html">celldancer.to_dynamo</a></li>
<li class="toctree-l2"><a class="reference internal" href="celldancer.export_velocity_to_dynamo.html">celldancer.export_velocity_to_dynamo</a></li>
<li class="toctree-l2"><a class="reference internal" href="celldancer.velocity.html">celldancer.velocity</a></li>
<li class="toctree-l2"><a class="reference internal" href="celldancer.compute_cell_velocity.html">celldancer.compute_cell_velocity</a></li>
<li class="toctree-l2"><a class="reference internal" href="celldancer.pseudo_time.html">celldancer.pseudo_time</a></li>
<li class="toctree-l2"><a class="reference internal" href="celldancer.embedding_kinetic_para.html">celldancer.embedding_kinetic_para</a></li>
<li class="toctree-l2"><a class="reference internal" href="celldancer.cdplt.scatter_gene.html">celldancer.cdplt.scatter_gene</a></li>
<li class="toctree-l2"><a class="reference internal" href="celldancer.cdplt.scatter_cell.html">celldancer.cdplt.scatter_cell</a></li>
<li class="toctree-l2"><a class="reference internal" href="celldancer.cdplt.plot_kinetic_para.html">celldancer.cdplt.plot_kinetic_para</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">celldancer.cdplt.PTO_Graph</a></li>
<li class="toctree-l2"><a class="reference internal" href="celldancer.simulation.simulate.html">celldancer.simulation.simulate</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release_notes.html">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">Frequently asked questions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_preprocessing.html">Data Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/case_study_gastrulation.html">Case study 1: Gastrulation erythroid maturation</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/case_study_neuro.html">Case Study 2: Mouse hippocampus development</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/case_study_pancreas.html">Case study 3: Pancreatic endocrinogenesis</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/case_study_hgforebrian.html">Case study 4: Human embryo glutamatergic neurogenesis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Application of dynamo</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks/case_study_pancreas_dynamo.html">Downstream analysis using Dynamo</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">cellDancer</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="API.html">API</a> &raquo;</li>
        
      <li>celldancer.cdplt.PTO_Graph</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/celldancer.cdplt.PTO_Graph.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="celldancer-cdplt-pto-graph">
<h1>celldancer.cdplt.PTO_Graph<a class="headerlink" href="#celldancer-cdplt-pto-graph" title="Permalink to this headline">Â¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="celldancer.cdplt.PTO_Graph">
<span class="sig-prename descclassname"><span class="pre">celldancer.cdplt.</span></span><span class="sig-name descname"><span class="pre">PTO_Graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellDancer_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'forceatlas2'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">PRNG_SEED</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_iters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_edge_bundling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_sizes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'off'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colorbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'on'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#celldancer.cdplt.PTO_Graph" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Graph visualization of selected cells reflecting their orders in
pseudotime (PseudoTimeOrdered_Graph: PTO_Graph). Embedding and pseudotime
of the cells are required. Each cell makes a node and the connections between
nodes are based on their separation in the embedding space and the strength
of the connection is proportional to the pseudotime difference (the larger
the pseudotime difference in absolute values, the weaker the connection).</p>
<p>Example usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">celldancer.plotting</span> <span class="kn">import</span> <span class="n">graph</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">graph</span><span class="o">.</span><span class="n">PTO_Graph</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span>
    <span class="n">load_cellDancer</span><span class="p">,</span>
    <span class="n">node_layout</span><span class="o">=</span><span class="s1">&#39;forcedirected&#39;</span><span class="p">,</span>
    <span class="n">use_edge_bundling</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">node_colors</span><span class="o">=</span><span class="s1">&#39;clusters&#39;</span><span class="p">,</span>
    <span class="n">edge_length</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">node_sizes</span><span class="o">=</span><span class="s1">&#39;pseudotime&#39;</span><span class="p">,</span>
    <span class="n">colorbar</span><span class="o">=</span><span class="s1">&#39;on&#39;</span><span class="p">,</span>
    <span class="n">legend</span><span class="o">=</span><span class="s1">&#39;on&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, we use a force-directed node layout algorithm (<a class="reference external" href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0098679">ForceAtlas2</a>).
A connection is made between any two cells within 3 (unit in the embedding).
The resulted edge lengths indicate the time difference between nodes (the
closer in pseudotime, the shorter the edge length). Edge bundling is applied
to highlight important edges (trunks). The sizes of the nodes are
proportional to the pseudotime. The nodes are colored according to their
cell types (if given by the input data).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cellDancer_df</strong> (<cite>pandas.DataFrame</cite>) â Dataframe of velocity estimation, cell velocity, and pseudotime results.
Columns=[âcellIndexâ, âgene_nameâ,
âunspliceâ, âspliceâ,
âunsplice_predictâ, âsplice_predictâ,
âalphaâ, âbetaâ, âgammaâ,
âlossâ, âcellIDâ, âclustersâ, âembedding1â, âembedding2â,
âvelocity1â, âvelocity2â, âpseudotimeâ]</p></li>
<li><p><strong>node_layout</strong> (optional, <cite>str</cite> (default: forceatlas2)) â <p>Layout for the graph. Currently only supports the forceatlas2 and
embedding.</p>
<ul>
<li><p><cite>âforceatlas2â</cite> or <cite>âforcedirectedâ</cite>: treat connections as forces</p></li>
</ul>
<p>between connected nodes.</p>
<ul>
<li><p><cite>âembeddingâ</cite>: use the embedding as positions of the nodes.</p></li>
</ul>
</p></li>
<li><p><strong>PRNG_SEED</strong> (optional, <cite>int</cite>, or <cite>None</cite> (default: <cite>None</cite>)) â Seed to initialize the pseudo-random number generator.</p></li>
<li><p><strong>force_iters</strong> (optional, <cite>int</cite> (default: 2000)) â Number of passes for the force-directed layout calculation.</p></li>
<li><p><strong>use_edge_bundling</strong> (optional, <cite>bool</cite> (default: <cite>True</cite>)) â <cite>True</cite> if bundle the edges (computational demanding).
Edge bundling allows edges to curve and groups nearby ones together
for better visualization of the graph structure.</p></li>
<li><p><strong>node_colors</strong> (optional, <cite>str</cite> (default: <cite>None</cite>)) â <p>The node fill colors.
Possible values:</p>
<blockquote>
<div><ul>
<li><p><em>clusters</em>: color according to the clusters information of the
respective cells.</p></li>
<li><p><em>pseudotime</em>: colors according to the pseudotime of the
respective cells.</p></li>
<li><p>A single color format string.</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>edge_length</strong> (optional, <cite>float</cite> (default: <cite>None</cite>)) â The distance cutoff in the embedding between two nodes to determine
whether an edge should be formed (edge is formed when r &lt; <em>edge_length</em>).
By default, the mean of all the cell</p></li>
<li><p><strong>node_sizes</strong> (optional, <cite>float</cite> or <cite>numeric list-like</cite> or <cite>str</cite> (default: 5)) â The sizes of the nodes. If it is <cite>str</cite>, then the <cite>str</cite> has to be either one of those
{<cite>pseudotime</cite>, <cite>index</cite>, <cite>x</cite>, <cite>y</cite>} read from the <cite>nodes</cite> dataframe.</p></li>
<li><p><strong>legend</strong> (optional, <cite>str</cite> (default: âoffâ)) â <ul>
<li><p><cite>âoffâ</cite>/<cite>âonâ</cite>: Exclude/include the cell type legend on the plot.</p></li>
<li><p><cite>âonlyâ</cite>: Negelect the plot and only show the cell type legend.</p></li>
</ul>
</p></li>
<li><p><strong>colorbar</strong> (optional, <cite>str</cite> (default: âonâ)) â <ul>
<li><p><cite>âoffâ</cite>/<cite>âonâ</cite>: Show the colorbar in the case nodes are colored by <cite>pseudotime</cite>.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ax</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.axes.Axes</p>
</dd>
</dl>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="celldancer.simulation.simulate.html" class="btn btn-neutral float-right" title="celldancer.simulation.simulate" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="celldancer.cdplt.plot_kinetic_para.html" class="btn btn-neutral float-left" title="celldancer.cdplt.plot_kinetic_para" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright June, 2022.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>